<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate ggplot2-based spectrogram(s), which can be passed to paged_spectro — prep_static_ggspectro • dynaSpec</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Generate ggplot2-based spectrogram(s), which can be passed to paged_spectro — prep_static_ggspectro" />
<meta property="og:description" content="Can be used to generate single or segmented static spectrograms. Works as standalone,
but the returned object is also intended to feed into paged_spectro. Workflow: 1) use 
prep_static_ggspectro to crop, filter, segment and tweak all spectrogram parameters; 2) pass these
settings to paged_spectro to generate dynamic spectrogram video." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dynaSpec</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/maRce10/dynaSpec/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate ggplot2-based spectrogram(s), which can be passed to paged_spectro</h1>
    <small class="dont-index">Source: <a href='https://github.com/maRce10/dynaSpec/blob/master/R/prep_static_ggspectro.R'><code>R/prep_static_ggspectro.R</code></a></small>
    <div class="hidden name"><code>prep_static_ggspectro.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Can be used to generate single or segmented static spectrograms. Works as standalone,
but the returned object is also intended to feed into <code><a href='paged_spectro.html'>paged_spectro</a></code>. Workflow: 1) use 
prep_static_ggspectro to crop, filter, segment and tweak all spectrogram parameters; 2) pass these
settings to <code><a href='paged_spectro.html'>paged_spectro</a></code> to generate dynamic spectrogram video.</p>
    </div>

    <pre class="usage"><span class='fu'>prep_static_ggspectro</span>(<span class='no'>soundFile</span>,<span class='no'>destFolder</span>,<span class='no'>outFilename</span>,<span class='kw'>savePNG</span><span class='kw'>=</span><span class='no'>F</span>,<span class='kw'>colPal</span><span class='kw'>=</span><span class='st'>"inferno"</span>,<span class='kw'>crop</span><span class='kw'>=</span><span class='kw'>NULL</span>,
<span class='kw'>bg</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>filter</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>xLim</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='kw'>yLim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>,<span class='fl'>10</span>),<span class='kw'>plotLegend</span><span class='kw'>=</span><span class='no'>F</span>,<span class='kw'>onlyPlotSpec</span><span class='kw'>=</span><span class='no'>T</span>,<span class='kw'>ampTrans</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>min_dB</span><span class='kw'>=</span>-<span class='fl'>30</span>,<span class='kw'>wl</span><span class='kw'>=</span><span class='fl'>512</span>,
<span class='kw'>ovlp</span><span class='kw'>=</span><span class='fl'>90</span>,<span class='kw'>wn</span><span class='kw'>=</span><span class='st'>"blackman"</span>,<span class='kw'>specWidth</span><span class='kw'>=</span><span class='fl'>9</span>,<span class='kw'>specHeight</span><span class='kw'>=</span><span class='fl'>3</span>,<span class='kw'>colbins</span><span class='kw'>=</span><span class='fl'>30</span>,<span class='kw'>ampThresh</span><span class='kw'>=</span><span class='fl'>0</span>,<span class='kw'>bgFlood</span><span class='kw'>=</span><span class='no'>F</span>,<span class='kw'>fontAndAxisCol</span><span class='kw'>=</span><span class='kw'>NULL</span>,
<span class='kw'>optim</span><span class='kw'>=</span><span class='kw'>NULL</span>,<span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>soundFile</th>
      <td><p>should work with URLs, full and relative paths; handles .mp3 and .wav</p></td>
    </tr>
    <tr>
      <th>destFolder</th>
      <td><p>needs to be like "figures/spectrograms/" to be relative to working directory; goes to soundFile folder by default or working directory if soundFile is a URL; can specify "wd" to output to the working directory</p></td>
    </tr>
    <tr>
      <th>outFilename</th>
      <td><p>if left out, will use input name in output filename</p></td>
    </tr>
    <tr>
      <th>savePNG</th>
      <td><p>save static spectrograms as PNGs? They will be exported to destFolder</p></td>
    </tr>
    <tr>
      <th>colPal</th>
      <td><p>color palette; one of "viridis","magma","plasma","inferno","cividis" from the <code><a href='https://rdrr.io/pkg/viridis/man/reexports.html'>viridis</a></code> package OR a 2 value vector (e.g. c("white","black")), defining the start and end of a custom color gradient</p></td>
    </tr>
    <tr>
      <th>crop</th>
      <td><p>subset of recording to include; if crop=NULL, use whole file; if number, interpreted as crop first X.X sec; if c(X1,X2), interpreted as specific time interval in sec</p></td>
    </tr>
    <tr>
      <th>bg</th>
      <td><p>background color (defaults to 1st value of chosen palette)</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>apply a bandpass filter? Defaults to none (NULL). Expects 'c(0,2)' where sound from 0 to 2kHz would be filtered out</p></td>
    </tr>
    <tr>
      <th>xLim</th>
      <td><p>is the time limit in seconds for all spectrograms; i.e. page width in seconds for multi-page dynamic spectrograms (defaults to WAV file length, unless file duration &gt;5s)</p></td>
    </tr>
    <tr>
      <th>yLim</th>
      <td><p>is the frequency limits (y-axis); default is c(0,10) aka 0-10kHz</p></td>
    </tr>
    <tr>
      <th>ampTrans</th>
      <td><p>amplitude transform for boosting spectrum contrast; defaults to identity (actual dB values); specify a decimal number for the lambda value of scales::modulus_trans(); 2.5 is a good place to start. (This amplifies your loud values the most, while not increasing background noise much at all)</p></td>
    </tr>
    <tr>
      <th>wl</th>
      <td><p>window length for the spectrogram (low values= higher temporal res; high values= higher freq. res). Default 512 is a good tradeoff</p></td>
    </tr>
    <tr>
      <th>ovlp</th>
      <td><p>how much overlap (as percent) between sliding windows to generate spec? Default 90 looks good, but takes longer</p></td>
    </tr>
    <tr>
      <th>wn</th>
      <td><p>window name (slight tweaks on algorithm that affect smoothness of output) see <code><a href='https://rdrr.io/pkg/seewave/man/spectro.html'>spectro</a></code></p></td>
    </tr>
    <tr>
      <th>colbins</th>
      <td><p>default 30: increasing can smooth the color contours, but take longer to generate spec</p></td>
    </tr>
    <tr>
      <th>ampThresh</th>
      <td><p>amplitude threshold as a percent to cut out of recording (try 5 to start); default= no filtering (high data loss with this; not recommended; play with min_dB  and ampTrans first)</p></td>
    </tr>
    <tr>
      <th>bgFlood</th>
      <td><p>do you want the background color to spill into the axis margins? Default=F (i.e. white margins)</p></td>
    </tr>
    <tr>
      <th>fontAndAxisCol</th>
      <td><p>the color of legend text if onlyPlotSpec=T (since margins will be white, with black text); if bgFlood=T, this will be the color of axis margins, labels and legend text. If you don't supply this, it will be picked automatically to be white or black based on supplied bg color</p></td>
    </tr>
    <tr>
      <th>optim</th>
      <td><p>NULL by default; this is an experimental feature to simplify the dataframe of the FFT-processed waveform used to generate the spectrogram (currently does nothing)</p></td>
    </tr>
    <tr>
      <th>min_db</th>
      <td><p>the minimum decibel (quietest sound) to include in the spec; defaults to -30 (-40 would include quieter sounds; -20 would cut out all but very loud sounds)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a list with all spectrogram parameters, segmented WAV files (segWavs) and spectrograms spec; importantly, spec is a list of n=number of "pages"/segments; the first page is displayed by default</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Araya-Salas M &amp; Wilkins M R. (2020). *dynaSpec: dynamic spectrogram visualizations in R*. R package version 1.0.0.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='paged_spectro.html'>paged_spectro</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>{
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='kw'>pattern</span><span class='kw'>=</span><span class='st'>".wav"</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='kw'>package</span><span class='kw'>=</span><span class='st'>"dynaSpec"</span>))

<span class='co'># default behavior should be a decent start for good recordings; doesn't save anything, just plots</span>
<span class='fu'>prep_static_ggspectro</span>(<span class='no'>f</span>[<span class='fl'>1</span>])

<span class='co'># to use with paged_spectro or to do other stuff, you need to assign the</span>
<span class='co'># resulting object, but it will still always plot the first spec</span>
<span class='co'># let's add axes and boost the signal a smidge</span>
<span class='no'>femaleBarnSwallow</span> <span class='kw'>&lt;-</span> <span class='fu'>prep_static_ggspectro</span>(<span class='no'>f</span>[<span class='fl'>1</span>],<span class='kw'>destFolder</span><span class='kw'>=</span><span class='st'>"wd"</span>,
<span class='kw'>onlyPlotSpec</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>bgFlood</span><span class='kw'>=</span><span class='no'>T</span>,<span class='kw'>ampTrans</span><span class='kw'>=</span><span class='fl'>2</span>)

<span class='co'>#feels like we're missing a little bit of the quieter signals; let's lower the minimum amplitude threshold a bit</span>
<span class='no'>femaleBarnSwallow</span><span class='kw'>&lt;-</span><span class='fu'>prep_static_ggspectro</span>(<span class='no'>f</span>[<span class='fl'>1</span>],<span class='kw'>destFolder</span><span class='kw'>=</span><span class='st'>"wd"</span>,
<span class='kw'>onlyPlotSpec</span> <span class='kw'>=</span> <span class='no'>F</span>, <span class='kw'>bgFlood</span><span class='kw'>=</span><span class='no'>T</span>,<span class='kw'>ampTrans</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>min_dB</span><span class='kw'>=</span>-<span class='fl'>35</span>)

<span class='co'>#now for a male song  </span>
<span class='no'>maleBarnSwallow</span><span class='kw'>&lt;-</span><span class='fu'>prep_static_ggspectro</span>(<span class='no'>f</span>[<span class='fl'>2</span>],<span class='kw'>destFolder</span><span class='kw'>=</span><span class='st'>"wd"</span>,<span class='kw'>onlyPlotSpec</span> <span class='kw'>=</span> <span class='no'>F</span>,
<span class='kw'>bgFlood</span><span class='kw'>=</span><span class='no'>T</span>)

<span class='co'>#Nice, but the trill is fading out; I'm gonna signal boost and lower the min_dB</span>
<span class='no'>maleBarnSwallow</span><span class='kw'>&lt;-</span><span class='fu'>prep_static_ggspectro</span>(<span class='no'>f</span>[<span class='fl'>2</span>],<span class='kw'>destFolder</span><span class='kw'>=</span><span class='st'>"wd"</span>,<span class='kw'>onlyPlotSpec</span> <span class='kw'>=</span> <span class='no'>F</span>,
<span class='kw'>bgFlood</span><span class='kw'>=</span><span class='no'>T</span>,<span class='kw'>ampTrans</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>min_dB</span><span class='kw'>=</span>-<span class='fl'>40</span>)

<span class='co'>#much stronger, now let's combine them (you need the cowplot package)</span>

<span class='kw pkg'>cowplot</span><span class='kw ns'>::</span><span class='fu'>plot_grid</span>(<span class='no'>femaleBarnSwallow</span>$<span class='no'>spec</span><span class='kw'>[[</span><span class='fl'>1</span>]]+<span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span>(<span class='fl'>0</span>,<span class='fl'>5</span>)+<span class='fu'>ggtitle</span>(<span class='st'>"female barn swallow song"</span>),
<span class='no'>maleBarnSwallow</span>$<span class='no'>spec</span><span class='kw'>[[</span><span class='fl'>1</span>]]+<span class='fu'><a href='https://rdrr.io/r/graphics/plot.window.html'>xlim</a></span>(<span class='fl'>0</span>,<span class='fl'>5</span>)+<span class='fu'>ggtitle</span>(<span class='st'>"male barn swallow song"</span>),<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>labels</span><span class='kw'>=</span><span class='st'>"auto"</span>)

<span class='fu'>ggsave</span>(<span class='st'>"M&amp;F_barn_swallow_song_specs.jpeg"</span>)


<span class='co'># see more examples at https://marce10.github.io/dynaSpec/</span>
}</div><div class='output co'>#&gt; <span class='error'>Error in xlim(segLens[i], segLens[i + 1]): could not find function "xlim"</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marcelo Araya-Salas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


